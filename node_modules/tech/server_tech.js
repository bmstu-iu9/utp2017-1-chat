var db = require('db');
var config = require('config');
var log = require('tech').log;

var stdin = process.openStdin();

/**
 * Module for special commands, which can be entered
 * directly while the server is running
 */

module.exports = stdin.addListener("data", function (d) {
    var s = d.toString().trim();
    switch (s) {
        case "DELETE UDB":
            db.users.deleteAllUsers();
            log.info("USERS DB is deleted");
            break;
        case "DELETE SDB":
            db.sessions.deleteAllSessions();
            log.info("SESSIONS DB is deleted");
            break;
        case "DELETE DDB":
            db.dialogs.deleteAllRooms();
            log.info("DIALOGS DB is deleted");
            break;
        case "CLEAR":
            db.sessions.deleteAllSessions();
            db.users.deleteAllUsers();
            db.dialogs.deleteAllRooms();
            log.info("All dbs are cleared");
            break;
        default:
            console.log("No such command");
            break;
    }
});